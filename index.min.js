"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),Element.prototype._getBoundingClientRect=Element.prototype.getBoundingClientRect,Element.prototype.getBoundingClientRect=function(){const e=Element.prototype._getBoundingClientRect.call(this);return e.x=e.left,e.y=e.top,e},window.setDragImageIEPreload=function(e){var t,n;t=document.body,(n=document.createElement("div")).style.background='url("'+e.src+'")',n.style.position="absolute",n.style.opacity=.001,t.appendChild(n),setTimeout(function(){t.removeChild(n)},5e3)},"function"!=typeof DataTransfer.prototype.setDragImage&&(DataTransfer.prototype.setDragImage=function(e,t,n){var o,i,r,a,c,d;for(i=["."+(o="setdragimage-ie-dragging-"+Math.round(Math.random()*Math.pow(10,5))+"-"+Date.now()),"{",'background: url("'+e.src+'") no-repeat #fff 0 0 !important;',"width: "+e.width+"px !important;","height: "+e.height+"px !important;","text-indent: -9999px !important;","border: 0 !important;","outline: 0 !important;","}","."+o+" * {","display: none !important;","}"],(r=document.createElement("style")).innerText=i.join(""),(a=document.getElementsByTagName("head")[0]).appendChild(r),c=DataTransfer.prototype.setDragImage.caller;!(c.arguments[0]instanceof DragEvent);)c=c.caller;(d=c.arguments[0].target).classList.add(o),setTimeout(function(){a.removeChild(r),d.classList.remove(o)},0)});var Block=function(e,t){var n=document.createElement("div");n.className="block",n.draggable="true",void 0!==t&&(n.innerHTML=t);var o=function(e){},i=function(e){};return n.addEventListener("click",function(t){if(null===document.querySelector(".block.start"))n.className="block on start",isSelected=!0;else{n.className="block on end",isSelected=!1;var o=document.querySelector(".block.start"),i=document.querySelector(".block.end");e.connect(o,i),o.classList.remove("start"),i.classList.remove("end")}}),{appendTo:function(e){e.appendChild(n)},remove:function(){n.remove()},setId:function(e){n.id=e},setLeft:function(e){var t=n.clientWidth;n.style.left=e-t/2+"px"},getWidth:function(){return n.clientWidth},setTop:function(e){var t=n.clientHeight;n.style.top=e-t/2+"px"},getHeight:function(){return n.clientHeight},setClass:function(e){n.className=e},onDragStart:function(e){n.addEventListener("dragstart",function(t){e(t),o(t),i(t),n.className="block"})},onDrag:function(e){n.addEventListener("drag",function(t){e(t),o(t),i(t),n.className="block on"})},onDragEnd:function(e){n.addEventListener("dragend",function(t){e(t),o(t),i(t)})},onClick:function(e,t){},onMoveLeftLine:function(e){o=e},onMoveRightLine:function(e){i=e}}},Line=function(){var e=document.createElementNS("http://www.w3.org/2000/svg","line");return e.setAttribute("stroke","black"),{appendTo:function(t){t.appendChild(e)},remove:function(){e.remove()},setId:function(t){e.id=t},setX1:function(t){e.setAttribute("x1",t)},setY1:function(t){e.setAttribute("y1",t)},setX2:function(t){e.setAttribute("x2",t)},setY2:function(t){e.setAttribute("y2",t)}}},Menu=function(e,t,n){var o=document.getElementById(t),i={};o.addEventListener("dragstart",function(t){i=new Block(e,n),e.addBlock(i);var o=document.createElement("img");t.dataTransfer.setDragImage(o,0,0)}),o.addEventListener("drag",function(e){i.setLeft(e.pageX),i.setTop(e.pageY),i.setClass("block on")}),o.addEventListener("dragend",function(e){i.setLeft(e.pageX),i.setTop(e.pageY)})},Workspace=function(e){var t=0,n=[{id:"",component:{}}],o=0,i=[{id:"",component:{}}],r=0,a=[{id:"",startBlockId:"",endBlockId:"",lineId:""}],c=document.getElementById(e),d=document.createElementNS("http://www.w3.org/2000/svg","svg");return d.id="lineArea",d.style.position="relative",d.style.width="100%",d.style.height="100%",c.appendChild(d),{connect:function(e,t){var c=function(e,t){var n=new Line,r="l"+o++;return n.setId(r),n.appendTo(d),i.push({id:r,component:n}),n}(),s=e.id,l=t.id,u="c"+r++;a.push({id:u,startBlockId:s,endBlockId:l,lineId:c.id}),c.setX1(e.getBoundingClientRect().x+100),c.setY1(e.getBoundingClientRect().y+100),c.setX2(t.getBoundingClientRect().x+100),c.setY2(t.getBoundingClientRect().y+100),startBlockConponent=n.filter(function(e){return e.id===s})[0].component,startBlockConponent.onMoveRightLine(function(e){c.setX1(e.pageX),c.setY1(e.pageY)}),endBlockConponent=n.filter(function(e){return e.id===l})[0].component,endBlockConponent.onMoveLeftLine(function(e){c.setX2(e.pageX),c.setY2(e.pageY)})},disconnect:function(e){a.filter(function(t,n){t.id===e&&a.splice(n,1)})},addBlock:function(e){var o="b"+t++;return e.setId(o),e.appendTo(c),e.onDragStart(function(e){img=document.createElement("div"),e.dataTransfer.setDragImage(img,0,0)}),e.onDrag(function(t){console.log(t),e.setLeft(t.pageX),e.setTop(t.pageY)}),e.onDragEnd(function(t){e.setLeft(t.pageX),e.setTop(t.pageY)}),n.push({id:o,component:e}),o}}};